# Gemini API 部署检查清单

## 🚀 服务器端配置

### 1. 环境变量设置
- [ ] `GEMINI_API_KEY` - 已设置有效的 Gemini API 密钥
- [ ] `NODE_ENV` - 设置为 `production`（生产环境）
- [ ] `CORS_ENABLED` - 设置为 `true`（如果需要跨域访问）

### 2. 服务器配置
- [ ] 服务器已启动并运行在正确的端口
- [ ] 域名 `tyo.tobenot.top` 已正确解析到服务器 IP
- [ ] SSL 证书已正确配置（HTTPS）
- [ ] 防火墙允许相应端口的访问

### 3. 网络配置
- [ ] 服务器可以访问 `https://generativelanguage.googleapis.com`
- [ ] 网络连接稳定，延迟合理
- [ ] 没有代理或防火墙阻止 API 请求

## 🌐 前端配置

### 1. 基础设置
- [ ] 使用正确的 API 基础 URL：`https://tyo.tobenot.top`
- [ ] 客户端库 `gemini-client.js` 已正确引入
- [ ] 错误处理机制已实现

### 2. CORS 配置
- [ ] 前端域名在服务器的 CORS 允许列表中
- [ ] 浏览器支持所需的 Web API
- [ ] 没有浏览器扩展阻止请求

### 3. 用户体验
- [ ] 加载状态已实现
- [ ] 错误信息友好且有用
- [ ] 流式响应有适当的视觉反馈

## 🔧 测试检查

### 1. 基础功能测试
- [ ] 服务器健康检查：`GET /health`
- [ ] 基本聊天功能：`POST /v1/chat/completions`
- [ ] 流式聊天功能：`POST /v1/chat/completions` (stream: true)

### 2. 模型测试
- [ ] `gemini-1.5-pro` 模型正常工作
- [ ] `gemini-1.5-flash` 模型正常工作
- [ ] `gemini-1.0-pro` 模型正常工作

### 3. 错误处理测试
- [ ] 网络错误处理
- [ ] 认证错误处理
- [ ] 请求超时处理
- [ ] 服务器错误处理

## 📊 性能检查

### 1. 响应时间
- [ ] 基本请求响应时间 < 5 秒
- [ ] 流式响应首字节时间 < 2 秒
- [ ] 服务器健康检查响应时间 < 1 秒

### 2. 并发处理
- [ ] 可以处理多个并发请求
- [ ] 队列机制正常工作
- [ ] 没有内存泄漏

### 3. 错误率
- [ ] 错误率 < 1%
- [ ] 超时率 < 0.1%
- [ ] 认证失败率 < 0.01%

## 🔒 安全检查

### 1. 认证
- [ ] API 密钥安全存储
- [ ] 没有在客户端暴露敏感信息
- [ ] 请求日志不包含敏感数据

### 2. 访问控制
- [ ] CORS 配置正确
- [ ] 没有不必要的开放端口
- [ ] 防火墙规则正确

### 3. 数据保护
- [ ] 用户数据不泄露
- [ ] 请求内容不记录到日志
- [ ] 适当的日志轮转

## 📈 监控检查

### 1. 服务器监控
- [ ] CPU 使用率监控
- [ ] 内存使用率监控
- [ ] 网络流量监控
- [ ] 错误率监控

### 2. 应用监控
- [ ] API 响应时间监控
- [ ] 请求成功率监控
- [ ] 队列状态监控
- [ ] 模型使用情况监控

### 3. 告警设置
- [ ] 服务器宕机告警
- [ ] 错误率过高告警
- [ ] 响应时间过长告警
- [ ] API 密钥失效告警

## 🚨 故障恢复

### 1. 备份策略
- [ ] 服务器配置备份
- [ ] 环境变量备份
- [ ] SSL 证书备份

### 2. 恢复流程
- [ ] 服务器重启流程
- [ ] 配置恢复流程
- [ ] 数据恢复流程

### 3. 应急响应
- [ ] 联系信息更新
- [ ] 故障升级流程
- [ ] 用户通知机制

## 📝 文档检查

### 1. 技术文档
- [ ] API 文档完整
- [ ] 部署文档完整
- [ ] 故障排除文档完整

### 2. 用户文档
- [ ] 使用指南清晰
- [ ] 示例代码完整
- [ ] 常见问题解答

### 3. 运维文档
- [ ] 监控指南
- [ ] 故障处理流程
- [ ] 维护计划

## ✅ 最终检查

### 部署前
- [ ] 所有测试通过
- [ ] 性能指标达标
- [ ] 安全检查通过
- [ ] 文档完整

### 部署后
- [ ] 功能验证通过
- [ ] 监控正常
- [ ] 用户反馈良好
- [ ] 性能稳定

### 持续维护
- [ ] 定期检查清单
- [ ] 性能优化
- [ ] 安全更新
- [ ] 功能扩展

---

**注意**: 这个检查清单应该根据具体项目需求进行调整。建议在每次部署前都进行完整的检查。